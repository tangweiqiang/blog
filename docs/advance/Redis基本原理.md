# Redis基本原理

## redis快的原理
redis快的原因:  
- 基于内存  
- 数据结构简单  
- 采用单线程  
- 多路i/o复用  
## redis过期策略
- 定期删除： redis 默认每隔 100ms 就会随机抽取一些设置了过期的 key，检查是否过期，如过期则删除；  
- 惰性删除： 获取 key 的时候，如果此时 key 已经过期，就删除，不会返回任何东西。
## redis的内存淘汰机制
redis 内存淘汰机制有以下几个：
- noeviction: 当内存不足以容纳新写入数据时，新写入操作会报错，这个一般没人用吧，实在是太恶心了。
- **allkeys-lru**：当内存不足以容纳新写入数据时，在**键空间**中，移除最近最少使用的 key（这个是**最常用**的）。
- allkeys-random：当内存不足以容纳新写入数据时，在**键空间**中，随机移除某个 key，这个一般没人用吧，为啥要随机，肯定是把最近最少使用的 key 给干掉啊。
- volatile-lru：当内存不足以容纳新写入数据时，在**设置了过期时间的键空间**中，移除最近最少使用的 key（这个一般不太合适）。
- volatile-random：当内存不足以容纳新写入数据时，在**设置了过期时间的键空间**中，**随机移除**某个 key。
- volatile-ttl：当内存不足以容纳新写入数据时，在**设置了过期时间的键空间**中，有**更早过期时间**的 key 优先移除。

## redis的事务一致性
## redis的持久化方案
redis的持久化方案有两种:  
1)RDB 持久化可以在指定的时间间隔内生成数据集的时间点快照（point-in-time snapshot）;
2)AOF 持久化记录服务器执行的所有写操作命令，并在服务器启动时，通过重新执行这些命令来还原数据集。 AOF 文件中的命令全部以 Redis 协议的格式来保存，新命令会被追加到文件的末尾。 Redis 还可以在后台对 AOF 文件进行重写（rewrite），使得 AOF 文件的体积不会超出保存数据集状态所需的实际大小。
## redis的分布式解决方案
1. 如何进行分布式  
redis本身支持分布式，可以通过设置成分布式
)分布式之后查找是发送到任意节点，然后对应的节点从该

2. 如何进行主从同步，redis主从同步有两种方式： 
   * 在配置好主从之后，会通过RDB的方式发送一份快照给从机同步，
   * 后面如果主库发生修改，同样的命令也会发送给丛库进行同步


